school_notebooks:
  repo_id: "ai-forever/school_notebooks_EN"

  files:
    train_annotations: "annotations_train.json"
    val_annotations: "annotations_val.json"
    test_annotations: "annotations_test.json"
    images_zip: "images.zip"

  output_dir: "data/01_raw"

data_preparation:
  images_base_dir: "data/01_raw/images.zip"
  max_samples: "none" 

model_training:
  pretrained_model_name: "microsoft/trocr-base-handwritten"
  max_target_length: 128
  output_dir: "data/06_models/trocr-line"

  training_args:
    output_dir: "data/06_models/trocr-line-hf"
    overwrite_output_dir: true
    
    do_train: true
    do_eval: true
    predict_with_generate: true

    auto_find_batch_size: true
    num_train_epochs: 3

    save_strategy: "steps"
    eval_strategy: "steps"
    logging_strategy: "steps"

    logging_steps: 50
    save_steps: 1000
    eval_steps: 1000
    warmup_steps: 100
    
    fp16: false
    optim: "adafactor"

    load_best_model_at_end: true
    metric_for_best_model: "eval_cer"
    greater_is_better: false
    report_to: "none"